<!DOCTYPE html>
<html lang="ar">
<head>
    <meta charset="UTF-8">
    <title>Ø±Ø³Ø§Ù„Ø© Ø®Ø§ØµØ©</title>

    <!-- Ø±Ø¨Ø· Ù…Ù„Ù CSS -->
    <link rel="stylesheet" href="cards-site.css">

</head>
<body>

    <!-- Ø§Ù„ÙƒØ§Ø±Øª -->
    <div class="card">
        <!-- Ø§Ù„Ø±Ø³Ø§Ù„Ø© -->
        <h1 id="message">I love you â¤ï¸</h1>

        <!-- Ø§Ù„ØµÙˆØ±Ø© -->
        <img id="image" src="photo1.jpg" alt="ØµÙˆØ±Ø© Ø§Ù„Ø±Ø³Ø§Ù„Ø©">

        <!-- Voice Note -->
        <div class="voice-note">
            <button id="playBtn">â–¶</button>
            <div class="wave">
                <span></span><span></span><span></span>
                <span></span><span></span><span></span>
            </div>
            <span id="time">0:00</span>
        </div>

        <!-- Ù†Øµ Ø«Ø§Ø¨Øª -->
        <p class="footer">â¤ï¸ Ø§Ù„ÙƒØ§Ø±Øª Ø¯Ù‡ Ù…Ø¹Ù…ÙˆÙ„ Ø¹Ø´Ø§Ù†Ù€Ùƒ ÙŠÙ‚Ù…Ø± </p>
    </div>

    <!-- Ù…Ù„Ù Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª -->
    <script src="cards-site.js"></script>

    <script>
        // Ø¬Ù„Ø¨ Ø±Ù‚Ù… Ø§Ù„ÙƒØ§Ø±Øª Ù…Ù† Ø§Ù„Ø±Ø§Ø¨Ø·
        const params = new URLSearchParams(window.location.search);
        const cardId = params.get("id");

        // Ø¹Ù†Ø§ØµØ± HTML
        const messageEl = document.getElementById("message");
        const imageEl = document.getElementById("image");
        const playBtn = document.getElementById("playBtn");
        const waveEl = document.querySelector(".wave");
        const timeEl = document.getElementById("time");

        // Ø¹Ù†ØµØ± Ø§Ù„ØµÙˆØª
        const audio = document.createElement("audio");

        // Ù„Ùˆ Ø§Ù„ÙƒØ§Ø±Øª Ù…ÙˆØ¬ÙˆØ¯
        if (cardsData[cardId]) {
            messageEl.innerText = cardsData[cardId].text;
            imageEl.src = cardsData[cardId].image;

            if(cardsData[cardId].audio){
                audio.src = cardsData[cardId].audio;
            } else {
                playBtn.style.display = "none"; // Ù„Ùˆ Ù…ÙÙŠØ´ ØµÙˆØª
            }
        } else {
            messageEl.innerText = "ğŸ˜… Ø§Ù„Ø±Ø³Ø§Ù„Ø© Ø¯ÙŠ ØºÙŠØ± Ù…ÙˆØ¬ÙˆØ¯Ø© ğŸ˜…";
            playBtn.style.display = "none";
        }

        // ØªØ´ØºÙŠÙ„ / Ø§ÙŠÙ‚Ø§Ù Ø§Ù„ØµÙˆØª
        playBtn.onclick = () => {
            if(audio.paused){
                audio.play();
                playBtn.innerText = "â¸";
                waveEl.classList.add("active");
            } else {
                audio.pause();
                playBtn.innerText = "â–¶";
                waveEl.classList.remove("active");
            }
        };

        // ØªØ­Ø¯ÙŠØ« Ø§Ù„ÙˆÙ‚Øª
        audio.ontimeupdate = () => {
            let m = Math.floor(audio.currentTime / 60);
            let s = Math.floor(audio.currentTime % 60);
            timeEl.innerText = `${m}:${s < 10 ? "0" : ""}${s}`;
        };
        // Ù„Ù…Ø§ Ø§Ù„ØµÙˆØª ÙŠØ®Ù„Øµ ÙŠØ±Ø¬Ø¹ Ø²Ø±Ø§Ø± Ø§Ù„ØªØ´ØºÙŠÙ„ Ù„Ù„Ù…Ø«Ù„Ø« ÙˆÙŠÙˆÙ‚Ù Ø§Ù„Ù…ÙˆØ¬Ø©
        audio.onended = () => {
        playBtn.innerText = "â–¶";       // Ø²Ø±Ø§Ø± Ø§Ù„ØªØ´ØºÙŠÙ„ ÙŠØ±Ø¬Ø¹
        waveEl.classList.remove("active"); // Ø§Ù„Ù…ÙˆØ¬Ø© ØªØªÙˆÙ‚Ù
};

    </script>

</body>
</html>
